require(["jquery","utils","dot","paipaiSDK"],function(a,b,c,d){"use strict";var e={isLoadingLeft:!1,isAllLoadLeft:!1,pageLeft:1,pageSize:10,init:function(){d.set.setRigthInfo({goUrl:"",logoUrl:"",contentTip:""}),this.addClick(),this.getDataXianZhi(),this.loadMore()},loadMore:function(){a(window).on("scroll",function(){var b=a(window).scrollTop(),c=a(window).height(),d=a(".income-lists").height();!e.isLoadingLeft&&!e.isAllLoadLeft&&b+c+300>d&&(e.pageLeft+=1,e.isLoadingLeft=!0,e.getDataXianZhi())})},addClick:function(){a(" .income-xianzhi").on("click",function(){a("span").addClass("red"),a(".income-huishou span").removeClass("red"),a(".income-xiancontent").show(),a(".income-huicontent").hide()}),a(" .income-huishou").on("click",function(){a("span").addClass("red"),a(".income-xianzhi span").removeClass("red"),a(".income-xiancontent").hide(),a(".income-huicontent").show()})},getDataXianZhi:function(){var c={url:b.getHost(1)+"/order/v1/deal/getSellingOrderList",data:{pageSize:e.pageSize,currentPage:e.pageLeft}};b.load(c).then(function(b){if(e.isLoadingLeft=!1,console.log(b.data),"0"==b.code)if(b.data&&a(".income-money").html(b.data.totalEarnMoney),b.data.pageInfo.result&&b.data.pageInfo.result.length>0){console.log(b.data.pageInfo.result);var c=Math.ceil(b.data.pageInfo.totalCount/e.pageSize);e.pageLeft>=c&&(e.isAllLoadLeft=!0),e.xianZhiLists(b.data.pageInfo.result)}else 1==e.pageLeft&&(a(".bgview").removeClass("hide"),a(".bgview").css({height:"14.47rem"}),a(".bgview img").attr("src","image/nopingjia.png"),a(".bgview img").css("margin-top","6.051173rem"),a(".bgview p").text("暂无收入记录"))},function(a){b.lightToast("获取收入列表异常")})},xianZhiLists:function(b){b=b||[],this.getTime(b),a(".income-lists").append(c.template(a(".incomeDetail").text())(b))},getTime:function(b){b=b||[],a.each(b,function(a,b){b.currentTime=b.buyerConfirmTime?e.formatDate(b.buyerConfirmTime):""})},formatDate:function(a){var b=new Date(a),c=b.getFullYear(),d=b.getMonth()+1,e=b.getDate(),f=b.getHours(),g=b.getMinutes(),h=b.getSeconds();return d=10>d?"0"+d:d,e=10>e?"0"+e:e,f=10>f?"0"+f:f,g=10>g?"0"+g:g,h=10>h?"0"+h:h,c+"-"+d+"-"+e+" "+f+":"+g}};e.init()});