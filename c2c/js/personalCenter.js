require(["jquery","utils","dot"],function(a,b,c){var d={obj:{uin:""},init:function(){d.getUserInfo()},getUserInfo:function(){var a={url:b.getHost()+"/user/getUserByUin?uin="};b.load(a).then(function(a){if(0!=a.code)return void b.lightToast(a.tip||"网络出错，请稍后再试");var c={url:b.getHost()+"/user/getUserDetailByUin?uin="+a.data.uin};b.load(c).then(function(a){return 0!=a.code?void b.lightToast(a.tip||"网络出错，请稍后再试"):void d.saveData(a.data)},function(a){b.lightToast("网络出错，请稍后再试")})},function(a){b.lightToast("网络出错，请稍后再试")})},saveData:function(a){d.obj.nickname=a.nickname,d.obj.icon=a.icon,d.obj.earnMoney=a.earnMoney||0,d.obj.whiteScore=a.whiteScore,d.obj.bai_level=a.bai_level,d.obj.isRealName=a.isRealName,d.obj.isWhiteCredit=a.isWhiteCredit,d.obj.allOrderUrl=a.allOrderUrl,d.obj.waitPayOrderUrl=a.waitPayOrderUrl,d.obj.waitReceiptOrderUrl=a.waitReceiptOrderUrl,d.obj.recoveryOrderUrl=a.recoveryOrderUrl,d.obj.sellUrl="//"+a.sellUrl,d.obj.soldCnt=a.soldCnt,d.obj.buyUrl="//"+a.buyUrl,d.obj.buyCnt=a.buyCnt,d.obj.help=a.help;var b="";switch(a.bai_level){case"5":b="信用一般";break;case"4":b="信用中等";break;case"3":b="信用良好";break;case"2":b="信用优秀";break;case"1":b="信用极好";break;default:b="信用未知"}var c="";c=!a.whiteScore||a.whiteScore<0?0:a.whiteScore>100?100:a.whiteScore,d.obj.whiteStr=b,d.obj.whiteCanvas=c,1==d.obj.isWhiteCredit&&d.drawCanvas(),d.renderPage()},renderPage:function(){var b=d.obj;a("img.personal-pic").attr("src",b.icon),a(".personal-center-name div").text(b.nickname),1==b.isRealName&&(a("span.personal-name-credited").css("background-image","url(image/personal/mine_name_credited.png)"),a("span.personal-name-credited").css("display","inline-block")),1==b.isWhiteCredit&&(a("span.personal-xiaobai-credited").css("background-image","url(image/personal/mine_xiaobai_credited.png)"),a("span.personal-xiaobai-credited").css("display","inline-block")),a(".personal-center-money span").text(b.earnMoney),b.whiteCanvas>50?a(".credit-top-text .left-arrow").html("<div>"+b.whiteScore.toFixed(1)+"</div><div>"+b.whiteStr+"</div>"):a(".credit-top-text .right-arrow").html("<div>"+b.whiteScore.toFixed(1)+"</div><div>"+b.whiteStr+"</div>"),a(".personal-center-title a").attr("href","//"+b.allOrderUrl),a("a#wait-pay").attr("href","//"+b.waitPayOrderUrl),a("a#wait-receive").attr("href","//"+b.waitReceiptOrderUrl),a("a#colection").attr("href","//"+b.recoveryOrderUrl),a("a#sold").attr("href","//"+b.sellUrl),a("a#sold span").text("("+b.soldCnt+")"),a("a#purchase").attr("href","//"+b.buyUrl),a("a#purchase span").text("("+b.buyCnt+")"),a("a#help").attr("href","//paipai.m.jd.com/c2c/helpCenter.html"),a(".personal-center-loading").hide()},drawCanvas:function(){var a={bgid:"#bg",maskid:"#mask",circleid:"#circle",x:170,y:196,radius:148,perV:d.obj.whiteCanvas,initLoaded:0};d.progress.init(a),d.progress.drawBgLayer(),d.progress.drawMaskLayer()},progress:{bgid:null,maskid:null,circleid:null,x:0,y:0,radius:0,perV:0,load:0,bgctx:null,maskctx:null,circlectx:null,init:function(a){this.bgid=a.bgid,this.maskid=a.maskid,this.circleid=a.circleid,this.x=a.x,this.y=a.y,this.radius=a.radius,this.perV=a.perV,this.load=a.initLoaded,bgctx=document.querySelector(this.bgid).getContext("2d"),circlectx=document.querySelector(this.circleid).getContext("2d"),maskctx=document.querySelector(this.maskid).getContext("2d")},drawBgLayer:function(){bgctx.beginPath(),bgctx.lineWidth=4,bgctx.strokeStyle="rgba(255,255,255,0.4)",bgctx.arc(this.x,this.y,this.radius,5/6*Math.PI,1/6*Math.PI,!1),bgctx.stroke()},drawMaskLayer:function(){var b=setInterval(function(){d.progress.load<=d.progress.perV?(d.progress.drawCircle(),d.progress.load+=1):(clearInterval(b),b=null,d.obj.whiteCanvas>95?(a(".credit-top-text .left-arrow").css({top:d.obj.py-2+"px",right:-d.obj.px+26+"px"}),a(".credit-top-text .left-arrow").show()):d.obj.whiteCanvas>85&&d.obj.whiteCanvas<=95?(a(".credit-top-text .left-arrow").css({top:d.obj.py-5+"px",right:-d.obj.px+26+"px"}),a(".credit-top-text .left-arrow").show()):d.obj.whiteCanvas>75&&d.obj.whiteCanvas<=85?(a(".credit-top-text .left-arrow").css({top:d.obj.py-7+"px",right:-d.obj.px+26+"px"}),a(".credit-top-text .left-arrow").show()):d.obj.whiteCanvas>65&&d.obj.whiteCanvas<=75?(a(".credit-top-text .left-arrow").css({top:d.obj.py-9+"px",right:-d.obj.px+26+"px"}),a(".credit-top-text .left-arrow").show()):d.obj.whiteCanvas>50&&d.obj.whiteCanvas<=65?(a(".credit-top-text .left-arrow").css({top:"8.4107px",right:"-38.7338px"}),a(".credit-top-text .left-arrow").show()):d.obj.whiteCanvas<=50&&d.obj.whiteCanvas>=35?(a(".credit-top-text .right-arrow").css({top:"8.4107px",left:"-38.7338px"}),a(".credit-top-text .right-arrow").show()):d.obj.whiteCanvas<35&&d.obj.whiteCanvas>=25?(a(".credit-top-text .right-arrow").css({top:d.obj.py-9+"px",left:d.obj.px-59+"px"}),a(".credit-top-text .right-arrow").show()):d.obj.whiteCanvas<25&&d.obj.whiteCanvas>=15?(a(".credit-top-text .right-arrow").css({top:d.obj.py-7+"px",left:d.obj.px-59+"px"}),a(".credit-top-text .right-arrow").show()):d.obj.whiteCanvas<15&&d.obj.whiteCanvas>=5?(a(".credit-top-text .right-arrow").css({top:d.obj.py-5+"px",left:d.obj.px-59+"px"}),a(".credit-top-text .right-arrow").show()):d.obj.whiteCanvas<5&&(a(".credit-top-text .right-arrow").css({top:d.obj.py-2+"px",left:d.obj.px-59+"px"}),a(".credit-top-text .right-arrow").show()))},10)},drawCircle:function(){var a=this.load/100*(4/3)+5/6;a>2&&(a-=2);var b=a*Math.PI;maskctx.clearRect(0,0,500,500),maskctx.beginPath(),maskctx.lineWidth=4,maskctx.strokeStyle="#ffffff",maskctx.arc(this.x,this.y,this.radius,5/6*Math.PI,b,!1),maskctx.stroke();var c=3.14*a,e=this.x+this.radius*Math.cos(c-.03),f=this.y+this.radius*Math.sin(c-.03);d.obj.px=e/4,d.obj.py=f/4,circlectx.clearRect(0,0,500,500),circlectx.beginPath(),circlectx.arc(e,f,10,0,360,!1),circlectx.fillStyle="#ffffff",circlectx.fill()}}};d.init()});