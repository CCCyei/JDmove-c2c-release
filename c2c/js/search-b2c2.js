!function(){function a(a){document.body.scrollTop=document.documentElement.scrollTop=a}function b(){return document.body.scrollTop||document.documentElement.scrollTop}var c=0;open.onclick=function(){c=b(),document.body.classList.add("dialog-open"),document.body.style.top=-c+"px",mask.style.display="block"},close.onclick=function(){mask.style.display="none",document.body.classList.remove("dialog-open"),a(c)}}(),require(["jquery","utils","dot","JSSDK"],function(a,b,c,d){"use strict";var e;b.getParameter("key");e={count:"",isLoading:!1,isFirst:!0,init:function(){e.initPara(),e.addClick(),a(".ui-fix").removeClass("hide")},initPara:function(){var c=b.getParameter("reqQuery");if(b.isNotEmpty(c)){var d;try{if(d=JSON.parse(decodeURIComponent(c)),b.isNotEmpty(d)){window.sessionStorage.setItem("initQuery",d);var f=d.key,g=d.bizType;f&&""!==f&&3==b.getType()?a("title").html(f+"-商品搜索-拍拍 "):a("title").html("京东备件库 "),d.pageNo=1,a.extend(!0,e.query,d),e.search(!0,d)}}catch(h){var f=b.getParameter("key"),g=b.getParameter("bizType");b.getType(3)&&a("title").html(f+"-商品搜索-拍拍 "),e.query.key=f,e.query.bizType=g,e.search(!0)}}else{var f=b.getParameter("key"),g=b.getParameter("bizType");b.getType(3)&&a("title").html(f+"-商品搜索-拍拍 "),e.query.key=f,e.query.bizType=g,e.search(!0)}},query:{pageNo:1,pageSize:20,sort:{sortKey:"default",order:"desc"}},para:{firstTime:0},tempQuery:{},bodyScollHandler:function(){a(".ui-area-class").is(":visible")||a(".ui-area-class-color").is(":visible")||a(".backView").is(":visible")?a("body").addClass("dialog-open"):a("body").removeClass("dialog-open")},goScroll:function(){var a=b.getParameter("translateY");null!=a&&0!=a&&e.isFirst&&(window.scrollTo(0,a),e.isFirst=!1)},addScorll:function(){a(window).on("scroll",function(){var c=a(window).scrollTop(),d=a(window).height(),f=document.body.scrollHeight,g=b.setUrlParam(window.location.href,"translateY",c),h=(new Date).getTime(),i=e.para.firstTime;h-i>120&&(e.para.firstTime=h,history.replaceState("",document.title,g)),a(".ui-area-class").is(":hidden")&&a(".ui-area-class-color").is(":hidden")&&!e.isLoading&&c+d+300>f&&0!=c&&(e.query.pageNo+=1,e.isLoading=!0,Math.ceil(e.count/20)>=e.query.pageNo&&e.search(!0))})},addClick:function(){a(".ui-nav").undelegate("div","click").delegate("div","click",function(){var c=a(this).index();switch((0===c||1===c||2===c)&&e.animateScroll(a("body")),c){case 0:e.query.sort={sortKey:"default",order:"desc"},e.updateTopFilter(),e.search();break;case 1:e.query.sort={sortKey:"deal_num",order:"desc"},e.updateTopFilter(),e.search();break;case 2:b.isNotEmpty(e.query.sort)&&"price"==e.query.sort.sortKey?"desc"==e.query.sort.order?e.query.sort={sortKey:"price",order:"asc"}:e.query.sort={sortKey:"price",order:"desc"}:e.query.sort={sortKey:"price",order:"asc"},e.updateTopFilter(),e.search();break;case 3:a(".backView").show(),a(".panel-list").hide(),a(".index-list").hide(),a(".ui-area-class").is(":visible")&&a('.ui-card[type="brand"]').click(),a("ui-area-class-color").is(":visible")&&a('.ui-card[type="expand"]').click(),e.initRightFiler(),e.bodyScollHandler()}}),a('.ui-card[type="searchType"]').unbind("click").bind("click",function(){var b=a(this).attr("typeId");a(this).css({border:"1px solid red",background:"rgb(255,255,255)",color:"rgb(252,82,71)"}).siblings().css({border:"none",background:"rgb(239,239,239)",color:"rgb(140,140,140)"}),e.updateBiz(b),a(this).children("img").show()}),a(".ui-area-class .btn-right").unbind("click").bind("click",function(b){a(this).attr("clstag","pageclick|keycount|XS_M__201708151|23"),a(".ui-area-class").hide(),a(".ui-card").attr("state","1"),e.clickBrand=!1,a.extend(!0,e.query.brandList,e.tempQuery.brandList),e.animateScroll(a("body")),e.search(),e.bodyScollHandler()}),a(".ui-area-class .btn-ltft").unbind("click").bind("click",function(b){a(".ui-area-class .ui-li").css("color","rgb(23,23,23)"),a(".ui-area-class .ui-li").css("border","none"),a(".ui-area-class .ui-li").attr("state","1"),a(".ui-area-class .ui-li img").hide(),e.tempQuery.brandList&&e.tempQuery.brandList.length>0&&e.tempQuery.brandList.forEach(function(a){a.isSelect=!1}),e.bodyScollHandler(),b&&b.stopPropagation?b.stopPropagation():window.event.cancelBubble=!0}),a('.ui-card[type="brand"]').unbind("click").bind("click",function(){a(this).attr("clstag","pageclick|keycount|XS_M__201708151|19"),1==a(this).attr("state")?(a(this).attr("state","0"),a(".ui-area-class").show(),a(".ui-area-class-color").hide(),a('.ui-card[type="expand"]').attr("state","1"),e.bodyScollHandler(),a(this).find('img[src*="red"]').length?a('.ui-card[type="brand"] img').attr("src","image/up-red.png"):(a(this).css("background","white").css("border","1px solid rgb(245,245,245)"),a('.ui-card[type="brand"] img').attr("src","image/up.png")),a('.ui-card[type="expand"]').find('img[src*="red"]').length?a('.ui-card[type="expand"] img').attr("src","image/down-red.png"):(a('.ui-card[type="expand"]').css("background","rgb(245,245,245)").css("border","none"),a('.ui-card[type="expand"] img').attr("src","image/down.png")),a(".ui-area-class .ui-class").css("overflow","auto")):0==a(this).attr("state")&&(a(this).attr("state","1"),a(".ui-area-class").hide(),a(".ui-area-class-color").hide(),a('.ui-card[type="expand"]').attr("state","1"),e.bodyScollHandler(),a(this).find('img[src*="red"]').length?a('.ui-card[type="brand"] img').attr("src","image/down-red.png"):(a(this).css("background","rgb(245,245,245)").css("border","none"),a('.ui-card[type="brand"] img').attr("src","image/down.png"))),e.renderSearchBrandlist(e.query.brandList),e.tempQuery={},a.extend(!0,e.tempQuery,e.query),a(".ui-area-class .ui-li").unbind("click").bind("click",function(){e.tempQuery.brandList||(e.tempQuery.brandList=[],a.extend(!0,e.tempQuery.brandList,e.query.brandList));a(this).index();1==a(this).attr("state")?(a(this).css("color","rgb(252,82,71)"),a(this).attr("state","0"),e.tempQuery.brandList[a(this).index()].isSelect=!0):0==a(this).attr("state")&&(a(this).css("color","rgb(23,23,23)"),a(this).attr("state","1"),e.tempQuery.brandList[a(this).index()].isSelect=!1),a(this).children("img").toggle()})}),a(".ui-area-class-color .btn-right").unbind("click").bind("click",function(b){a(".ui-area-class-color").hide(),a(".ui-card").attr("state","1"),e.clickColor=!1,a.extend(!0,e.query.extAttrList,e.tempQuery.extAttrList),e.animateScroll(a("body")),e.search(),e.bodyScollHandler(),b&&b.stopPropagation?b.stopPropagation():window.event.cancelBubble=!0}),a(".ui-area-class-color .btn-ltft").unbind("click").bind("click",function(b){a(".ui-area-class-color .ui-li").css("color","rgb(23,23,23)"),a(".ui-area-class-color .ui-li").css("border","none"),a(".ui-area-class-color .ui-li").attr("state","1"),a(".ui-area-class-color .ui-li img").hide(),e.tempQuery.extAttrList[0]&&e.tempQuery.extAttrList[0].attrs.length>0&&e.tempQuery.extAttrList[0].attrs.forEach(function(a){a.isSelect=!1}),e.bodyScollHandler(),b&&b.stopPropagation?b.stopPropagation():window.event.cancelBubble=!0}),a('.ui-card[type="expand"]').unbind("click").bind("click",function(){a(this).attr("clstag","pageclick|keycount|XS_M__201708151|20"),1==a(this).attr("state")?(a(this).attr("state","0"),a(".ui-area-class-color").show(),a(".ui-area-class").hide(),a('.ui-card[type="brand"]').attr("state","1"),e.bodyScollHandler(),a(this).find('img[src*="red"]').length?a('.ui-card[type="expand"] img').attr("src","image/up-red.png"):(a(this).css("background","white").css("border","1px solid rgb(245,245,245)"),a('.ui-card[type="expand"] img').attr("src","image/up.png")),a('.ui-card[type="brand"]').find('img[src*="red"]').length?a('.ui-card[type="brand"] img').attr("src","image/down-red.png"):(a('.ui-card[type="brand"]').css("background","rgb(245,245,245)").css("border","none"),a('.ui-card[type="brand"] img').attr("src","image/down.png"))):0==a(this).attr("state")&&(a(this).attr("state","1"),a(".ui-area-class-color").hide(),a(".ui-area-class").hide(),e.bodyScollHandler(),a('.ui-card[type="brand"]').attr("state","1"),a(this).find('img[src*="red"]').length?a('.ui-card[type="expand"] img').attr("src","image/down-red.png"):(a(this).css("background","rgb(245,245,245)").css("border","none"),a('.ui-card[type="expand"] img').attr("src","image/down.png"))),e.renderSearchextAttrList(e.query.extAttrList[0].attrs),e.tempQuery={},a.extend(!0,e.tempQuery,e.query),a(".ui-area-class-color .ui-li").unbind("click").bind("click",function(){e.tempQuery.extAttrList||(e.tempQuery.extAttrList=[],a.extend(!0,e.tempQuery,e.query));var b=a(this).index();1==a(this).attr("state")?(a(this).css("color","rgb(252,82,71)"),a(this).attr("state","0"),e.tempQuery.extAttrList[0].attrs[b].isSelect=!0):0==a(this).attr("state")&&(a(this).css("color","rgb(23,23,23)"),a(this).attr("state","1"),e.tempQuery.extAttrList[0].attrs[b].isSelect=!1),a(this).children("img").toggle()})}),a(".ui-class").unbind("click").bind("click",function(a){a&&a.stopPropagation?a.stopPropagation():window.event.cancelBubble=!0}),a("#item-color li").unbind("click").bind("click",function(){var b=a(this).attr("i"),c=a(this).attr("j");1==a(this).attr("state")?(a(this).attr("state","0").css({border:"1px solid red",background:"rgb(255,255,255)",color:"rgb(252,82,71)"}),a(this).find("img").removeClass("hide"),e.tempQuery.extAttrList[b].attrs[c].isSelect=!0):0==a(this).attr("state")&&(a(this).attr("state","1").css({border:"none",background:"rgb(239,239,239)",color:"rgb(23,23,23)"}),a(this).find("img").addClass("hide"),e.tempQuery.extAttrList[b].attrs[c].isSelect=!1),a.extend(!0,e.query.extAttrList,e.tempQuery.extAttrList)}),a(".service").unbind("click").bind("click",function(b){1==a(this).attr("state")?(a(this).attr("state","0").css({border:"1px solid red",background:"rgb(255,255,255)",color:"rgb(252,82,71)"}),a(this).find("img").removeClass("hide"),e.tempQuery.serviceList[a(this).index()].selected=!0):0==a(this).attr("state")&&(a(this).attr("state","1").css({border:"none",background:"rgb(239,239,239)",color:"rgb(23,23,23)"}),a(this).find("img").addClass("hide"),e.tempQuery.serviceList[a(this).index()].selected=!1),b&&b.stopPropagation?b.stopPropagation():window.event.cancelBubble=!0}),a(".contentView").unbind("click").bind("click",function(a){"btn-sure"!=a.target.className&&(a&&a.stopPropagation?a.stopPropagation():window.event.cancelBubble=!0)}),a(".priceStr").unbind("click").bind("click",function(){var b=!1;1==a(this).attr("state")?(a(this).attr("state","0").css({border:"1px solid red",background:"rgb(255,255,255)",color:"rgb(252,82,71)"}).siblings().attr("state","1").css({border:"none",background:"rgb(239,239,239)",color:"rgb(23,23,23)"}),a(".inputView .left").val(a(this).attr("min")),a(".inputView .right").val(a(this).attr("max")),b=!0):0==a(this).attr("state")&&(a(this).attr("state","1").css({border:"none",background:"rgb(239,239,239)",color:"rgb(23,23,23)"}),b=!1);var c=a(this).index();e.tempQuery.priceList.forEach(function(d,e){if(e==c){if(d.isSelect=b,!b){var f=a(".inputView .left").val(),g=a(".inputView .right").val();f==d.min&&g==d.max&&(a(".inputView .left").val(""),a(".inputView .right").val(""))}}else d.isSelect=!1})}),a(".inputView input").unbind("input").bind("input",function(){a(".priceStr").each(function(){a(this).attr("state","1").css({border:"none",background:"rgb(239,239,239)",color:"rgb(23,23,23)"})}),e.query.priceList.forEach(function(a){a.isSelect=!1})}),a(".item-content-brand").unbind("click").bind("click",function(){1==a(this).attr("state")?(a(this).find("img").removeClass("hide"),a(this).attr("state","0").css({border:"1px solid red",background:"rgb(255,255,255)",color:"rgb(252,82,71)"}),e.tempQuery.brandList[a(this).index()].isSelect=!0):0==a(this).attr("state")&&(a(this).find("img").addClass("hide"),a(this).attr("state","1").css({border:"none",background:"rgb(239,239,239)",color:"rgb(23,23,23)"}),e.tempQuery.brandList[a(this).index()].isSelect=!1)}),a(".bottomView").undelegate(".allBrand","click").delegate(".allBrand","click",function(){a(".begin-list").hide(),a(".index-list").show()}),a(".ui-area-class").unbind("click").bind("click",function(){a(".ui-area-class").hide(),e.bodyScollHandler(),"品牌"==a('.ui-card[type="brand"] span').text()?(a('.ui-card[type="brand"] img').attr("src","image/down.png"),a('.ui-card[type="brand"]').css("background","rgb(245,245,245)").css("border","none")):(a('.ui-card[type="brand"] img').attr("src","image/down-red.png"),a('.ui-card[type="brand"]').css("background","white").css("border","1px solid red")),a(".ui-card").attr("state","1")}),a(".ui-area-class-color").unbind("click").bind("click",function(){a(".ui-area-class-color").hide(),"成色"==a('.ui-card[type="expand"]').text()?(a('.ui-card[type="expand"] img').attr("src","image/down.png"),a('.ui-card[type="expand"]').css("background","rgb(245,245,245)").css("border","none")):(a('.ui-card[type="expand"] img').attr("src","image/down-red.png"),a('.ui-card[type="expand"]').css("background","white").css("border","1px solid red")),a(".ui-card").attr("state","1"),e.bodyScollHandler()}),a(".backView").unbind("click").bind("click",function(b){e.tempQuery={},a(".backView").hide(),a(".begin-list").show(),e.bodyScollHandler(),"btn-sure"!=b.target.className&&(b&&b.stopPropagation?b.stopPropagation():window.event.cancelBubble=!0)}),a(".inputView .left,.inputView .right").unbind("blur").bind("blur",function(){e.filter.price(),e.bodyScollHandler()}),a(".inputView .left,.inputView .right").unbind("focus").bind("focus",function(){e.bodyScollHandler()}),a(".inputView .left,.inputView .right").keyup(function(){e.filter.price()}),a(".allClass").unbind("click").bind("click",function(b){a(".panel-list").show(),b&&b.stopPropagation?b.stopPropagation():window.event.cancelBubble=!0}),a(".btn-sure").unbind("click").bind("click",function(){e.tempQuery.serviceList&&e.tempQuery.serviceList.length>0&&a.extend(!0,e.query.serviceList,e.tempQuery.serviceList),e.tempQuery.priceList&&e.tempQuery.priceList.length>0&&a.extend(!0,e.query.priceList,e.tempQuery.priceList),e.tempQuery.brandList&&e.tempQuery.brandList.length>0&&a.extend(!0,e.query.brandList,e.tempQuery.brandList),e.tempQuery.extAttrList&&e.tempQuery.extAttrList.length>0&&a.extend(!0,e.query.extAttrList,e.tempQuery.extAttrList),a(".backView").hide(),e.bodyScollHandler(),e.search()}),a(".btn-reset").unbind("click").bind("click",function(a){e.rasetHandler(4),e.bodyScollHandler(),a&&a.stopPropagation?a.stopPropagation():window.event.cancelBubble=!0}),a(".li-header").unbind("click").bind("click",function(b){return a(this).hasClass("ui-cat")?(a(".panel-list").hide(),e.query.catList.forEach(function(a){a.children.forEach(function(a){a.isSelect=!1})}),e.query.cat=[],void e.rasetHandler(3)):(1==a(this).attr("state")?(a(this).next().removeClass("hide"),a(this).attr("state","0"),a(this).children("img").attr("src","image/Upward.png")):0==a(this).attr("state")&&(a(this).next().addClass("hide"),a(this).attr("state","1"),a(this).children("img").attr("src","image/select-down.png")),void(b&&b.stopPropagation?b.stopPropagation():window.event.cancelBubble=!0))}),a(".panel-list .li-line").unbind("click").bind("click",function(){var b=a(this).attr("i"),c=a(this).attr("j"),d=!1;(1==a(this).attr("state")||0==a(this).attr("state"))&&(d=!0),a(this).children("img").show(),e.query.catList.forEach(function(a){a.children.forEach(function(a){a.isSelect=!1})});var f=e.query.catList[b].children[c];f.isSelect=d,a(".panel-list").hide(),d?e.query.cat=[{name:f.name,catId:f.catId,field:f.field}]:e.query.cat=[],e.rasetHandler(3)}),a(".top-header-left").unbind("click").bind("click",function(){a(".panel-list").hide()}),a(".item-top .right").unbind("click").bind("click",function(){1==a(this).attr("state")?(a(this).find("img").show(),a(this).parent().next().removeClass("removeHeight"),a(this).attr("state","0"),a(this).children("img").attr("src","image/Upward.png")):0==a(this).attr("state")&&(a(this).parent().next().addClass("removeHeight"),a(this).attr("state","1"),a(this).children("img").attr("src","image/select-down.png"))}),a(".index-list").delegate(".li-line","click",function(){a(this).hasClass("brand-select")?a(this).removeClass("brand-select"):a(this).addClass("brand-select")}),a(".index-list").delegate(".top-header-right","click",function(){for(var b=a(".index-list").find(".li-line[class*=brand-select]"),c={},d=0;d<b.length;d++){var f=b[d],g=a(f).attr("data-brandId");c[g]=!0}for(var h=e.query.brandList,d=0;d<h.length;d++)c[h[d].brandId]?h[d].isSelect=!0:h[d].isSelect=!1;e.query.brandList=h,e.tempQuery.brandList=h,e.renderSearchextSeleatBrandList(h),a(".bottomView .item-top .right").unbind("click").bind("click",function(){1==a(this).attr("state")?(a(this).parent().next().removeClass("removeHeight"),a(this).attr("state","0")):0==a(this).attr("state")&&(a(this).parent().next().addClass("removeHeight"),a(this).attr("state","1"))}),a(".index-list").hide(),a(".begin-list").show()}),a(".index-list").delegate(".top-header-left","click",function(){a(".index-list").hide(),a(".begin-list").show()})},queryHandler:function(a,c){a.brandList&&a.brandList.length>0?a.brandList=a.brandList:b.isNotEmpty(c.brandList)&&c.brandList.length>0&&(a.brandList=c.brandList),a.extAttrList&&a.extAttrList.length>0?a.extAttrList=a.extAttrList:a.extAttrList=c.extAttrList,a.serviceList=c.serviceList,a.priceList&&a.priceList.length>0?a.priceList=a.priceList:a.priceList=c.priceList,a.catList&&a.catList.length>0?a.catList=a.catList:a.catList=c.catList,a.price=c.price},updatePageInfo:function(a,c){e.query.pageNo=a,b.isNotEmpty(c)?e.query.pageSize=c:e.query.pageSize="20"},updateKey:function(a){e.query.key=a},updateTop:function(a,b){var c,d;c=a?"default":a,d=b?"desc":b,e.query.sort={sortKey:c,order:d}},updateBiz:function(a){e.query.bizType=a,e.rasetHandler(1)},getQueryBuilder:{getSelectBrandList:function(){var a=[];return b.isNotEmpty(e.query.brandList)&&e.query.brandList.forEach(function(b){b.isSelect&&a.push({brandId:b.brandId,name:b.name})}),a},getChengSe:function(){var a=[];if(b.isNotEmpty(e.query.extAttrList)&&e.query.extAttrList.length>0){var c=e.query.extAttrList[0];if("99"==c.expandId){for(var d=[],f=0;f<c.attrs.length;f++){var g=c.attrs[f];g.isSelect&&d.push({key:g.key,value:g.value,name:g.name})}d.length>0&&a.push({expandId:c.expandId,attrs:d})}}return a},getExtAttrList:function(){var a=[];return b.isNotEmpty(e.query.extAttrList)&&e.query.extAttrList.forEach(function(b){for(var c=[],d=0;d<b.attrs.length;d++){var e=b.attrs[d];e.isSelect&&c.push({key:e.key,value:e.value,name:e.name})}c.length>0&&a.push({expandId:b.expandId,attrs:c})}),a},getService:function(){var a=[];return b.isNotEmpty(e.query.serviceList)&&e.query.serviceList.forEach(function(b){b.selected&&a.push({key:b.key,name:b.name,value:b.value})}),a},getPrice:function(){var c=[];if(b.isNotEmpty(e.query.priceList)&&(e.query.priceList||[]).forEach(function(a){a.isSelect&&c.push({min:a.min,max:a.max})}),!(b.isNotEmpty(c)&&c.length>0)){var d,f,g=a(".inputView .left").val(),h=a(".inputView .right").val();b.isNotEmpty(g)&&b.isNotEmpty(h)?(+g>+h?(d=h,f=g):(d=g,f=h),c.push({min:d,max:f})):b.isEmpty(g)&&b.isEmpty(h)||(b.isNotEmpty(g)?c.push({min:g}):c.push({min:0,max:h}))}return c}},filter:{price:function(){var c=parseInt(a(".inputView .left").val()),d=parseInt(a(".inputView .right").val());0>c?a(".inputView .left").val("0"):c>1e8?a(".inputView .left").val("99999999"):a(".inputView .left").val(c),0>d?a(".inputView .right").val("0"):d>1e8?a(".inputView .right").val("99999999"):a(".inputView .right").val(d),a(".priceStr").attr("state","1").css({border:"none",background:"rgb(239,239,239)",color:"rgb(23,23,23)"}),b.isNotEmpty(e.tempQuery.priceList)&&e.tempQuery.priceList.length>0&&e.tempQuery.priceList.forEach(function(a,b){a.isSelect=!1})}},rasetHandler:function(c){a(".inputView .left").val(""),a(".inputView .right").val(""),e.tempQuery={};var d={};a.extend(!0,d,e.query),e.query={},e.updatePageInfo(1),e.query.bizType=d.bizType,e.query.key=d.key,4==c?b.isEmpty(d.sort)?e.query.sort={sortKey:"default",order:"desc"}:e.query.sort=d.sort:3==c?(e.query.catList=d.catList,e.query.cat=d.cat,e.query.sort={sortKey:"default",order:"desc"}):e.query.sort={sortKey:"default",order:"desc"},e.updateTopFilter(),e.search()},searchQueryBuilder:function(){var a={};a.bizType=e.query.bizType,a.pageNo=e.query.pageNo,a.pageSize=e.query.pageSize,a.sort=e.query.sort,a.key=e.query.key;var c=e.getQueryBuilder.getSelectBrandList();c.length>0&&(a.brand=c);var d=e.getQueryBuilder.getExtAttrList();d.length>0&&(a.extAttrList=d);var f=e.getQueryBuilder.getService();f.length>0&&(a.service=f);var g=e.getQueryBuilder.getPrice();g.length>0&&(a.price=g);var h=e.query.cat;return b.isNotEmpty(h)&&h.length>0&&(a.cat=e.query.cat),a},isSelectCheck:function(){var a=!1;return(b.isNotEmpty(e.query.cat)&&e.query.cat.length>0||e.getQueryBuilder.getExtAttrList().length>0||e.getQueryBuilder.getSelectBrandList().length>0||e.getQueryBuilder.getService().length>0||e.getQueryBuilder.getPrice().length>0)&&(a=!0),a},initCenterFilter:function(c){b.isNotEmpty(c)&&c.data.filterList&&c.data.filterList.length>0&&(e.renderSearchFilterlist(c.data.filterList),e.updateBizFilter()),e.isSelectCheck()?(a(".ui-select img").attr("src","image/select-red.png"),a(".ui-select").css("color","red")):(a(".ui-select img").attr("src","image/select.png"),a(".ui-select").css("color","black"))},initRightFiler:function(){if(console.log(JSON.stringify(e.query.serviceList)),e.renderSearchextServiceList(e.query.serviceList),b.isNotEmpty(e.query.price)?(a(".inputView .left").val(e.query.price.min||0),a(".inputView .right").val(e.query.price.max||"")):(a(".inputView .left").val(""),a(".inputView .right").val("")),e.renderSearchextPriceList(e.query.priceList),e.query.brandList&&e.query.brandList.length>0){for(var c={},d=e.getQueryBuilder.getSelectBrandList(),f=0;f<d.length;f++)c[d.brandId]=c[d.name];if(e.renderSearchextSeleatBrandList(e.query.brandList),12==e.query.bizType||13==e.query.bizType){for(var g=e.query.brandList,h={},f=0;f<g.length;f+=1){var i=g[f],j=i.pinyin;h[j]||(h[j]=[]),c[i.brandId]==i.name&&(i.isSelect=!0),h[j].push(i)}var k=e.objKeySort(h);e.renderSearchextSeleatBrandSpellList(k)}a(".bottomView").show()}else a(".bottomView").hide();e.renderSearchextSeleatColorList(e.query.extAttrList),e.renderSearchextSeleatCatList(e.query.catList),b.isNotEmpty(e.query.cat)?a(".allClass .right").html(e.query.cat[0].name).css("color","red"):a(".allClass .right").html("全部").css("color","#8c8c8c"),e.getQueryBuilder.getService(),e.query.tempQuery={},a.extend(!0,e.tempQuery,e.query),e.addClick()},rendSearch:function(c){var d={};a.extend(!0,d,c),c.brand&&c.brand.length>0&&(c.brand=[]),1==c.pageNo?c.pageSize=100:c.pageSize=20;var f={url:b.getHost()+"/search/v1/search",data:{query:JSON.stringify(c)}};b.load(f).then(function(a){"0"==a.code?(e.query.brandList=a.data.brandList||[],e.query.attrsList=a.data.attrsList||[],d.brand&&d.brand.length>0&&d.brand.forEach(function(a){e.query.brandList.forEach(function(b){b.brandId==a.brandId&&(b.isSelect=!0)})}),e.initCenterFilter(a)):b.isNotEmpty(a.tip)?b.lightToast(a.tip):b.lightToast("获取搜索商品异常"),e.addClick()},function(a){b.isNotEmpty(response.tip)?b.lightToast(response.tip):b.lightToast("请求服务器失败，请稍后再试"),e.addClick()})},search:function(c,d){c||(e.updatePageInfo(1),e.animateScroll(a("body")),a(".backView").is(":visible")?a("body").addClass("dialog-open"):a("body").removeClass("dialog-open"));var f=!1;d?f=!0:d=e.searchQueryBuilder();var g={};a.extend(!0,g,d),1==d.pageNo?d.pageSize=100:d.pageSize=20;var h={url:b.getHost()+"/search/v1/search",data:{query:JSON.stringify(d)}},i={};i.bizType=d.bizType,i.pageNo=d.pageNo,i.pageSize=d.pageSize,i.sort=d.sort,i.key=d.key,b.isNotEmpty(d.brand)&&(i.brand=d.brand),b.isNotEmpty(d.service)&&(i.service=d.service);JSON.stringify(i);b.load(h).then(function(c){if("0"==c.code){a(".ui-area-class").hide(),a(".ui-area-class-color").hide();var g=c.data.query;g.brandList=c.data.brandList||[],g.extAttrList=c.data.extAttrList||[],g.serviceList=c.data.serviceList||[],g.priceList=c.data.priceList||[],g.price=c.data.customPrice||[],g.catList=c.data.catList||[],e.queryHandler(e.query,g),f&&e.rendSearch(d),e.count=c.data.count,e.initCenterFilter(c),e.initRightFiler(),e.updateTopFilter(),c.data.itemList&&c.data.itemList.length>0?(e.isLoading=!1,e.renderSearchList(c.data.itemList),e.addScorll(),a(".ui-goods-box").show(),a(".bgview").addClass("hide")):1==e.query.pageNo&&(a(".ui-goods-box").hide(),a(".bgview").removeClass("hide"),a(".bgview p").text("对不起，没有找到和"+e.query.key+"相关的结果"))}else b.isNotEmpty(c.tip)?b.lightToast(c.tip):b.lightToast("请求服务器失败，请稍后再试");e.addClick()},function(a){e.addClick()})},updateTopFilter:function(){if(b.isNotEmpty(e.query.sort)){var c=e.query.sort.sortKey,d=e.query.sort.order;a(".ui-price").css("color","rgb(0,0,0)"),a(".ui-push").css("color","rgb(0,0,0)"),a(".ui-alern").css("color","rgb(0,0,0)"),a(".ui-price .ui-up").attr("src","image/up.png"),a(".ui-price .ui-down").attr("src","image/down.png"),"default"==c?a(".ui-alern").css("color","rgb(252,82,71)"):"price"==c?(a(".ui-price").css("color","rgb(252,82,71)"),"asc"==d?(a(".ui-price .ui-up").attr("src","image/up-red.png"),a(".ui-price .ui-down").attr("src","image/down.png")):(a(".ui-price .ui-up").attr("src","image/up.png"),a(".ui-price .ui-down").attr("src","image/down-red.png"))):"deal_num"==c&&a(".ui-push").css("color","rgb(252,82,71)")}},updateBizFilter:function(){b.isNotEmpty(e.query.bizType)&&a(".ui-card[typeId="+e.query.bizType+"]").css({border:"1px solid red",background:"rgb(255,255,255)",color:"rgb(252,82,71)"}).siblings('[type="searchType"]').css({border:"none",background:"rgb(239,239,239)",color:"rgb(140,140,140)"})},renderSearchList:function(f,g){f=f||[],1==e.query.pageNo?(a(".ui-goods-box2").html(c.template(a(".renderSearchList").text())(f)),a(".ui-goods-box").html(c.template(a(".renderSearchList").text())(f))):(a(".ui-goods-box2").append(c.template(a(".renderSearchList").text())(f)),a(".ui-goods-box").append(c.template(a(".renderSearchList").text())(f)));var h=b.getLoginCodeType();a(".ui-goods").click(function(){var b=a(this).attr("usedNoBei");if(13==e.query.bizType){var b=a(this).attr("usedNoBei"),c="https://paipai.m.jd.com/m/goods_detail.html?usedNo="+b;try{"app"===h?d.Native.Jump.Mpage.toUrl({url:c}):location.href=c}catch(f){console.log(f)}}else if(12==e.query.bizType){var b=a(this).attr("usedNo");location.href="//item.m.jd.com/ware/view.action?wareId="+b}}),e.goScroll()},renderSearchFilterlist:function(b){for(var d=e.getQueryBuilder.getSelectBrandList()||[],f="",g=0;g<d.length;g++)f+=d[g].name+",";for(var h=e.getQueryBuilder.getChengSe()||[],i="",j=h[0]?h[0].attrs:[],g=0;g<j.length;g++)i+=j[g].name+",";(12==e.query.bizType||13==e.query.bizType)&&b.length>1&&(12==e.query.bizType?b[0].isSelect=!0:b[1].isSelect=!0),d.length>0&&2==b.length&&b.push({max:20,name:"品牌",type:"brand"}),h.length>0&&3==b.length&&b.push({max:20,name:"成色",type:"expand",typeId:"99"});var k=c.template(a(".renderSearchFilterlist").text())(b);a(".ui-nav-class").html(k),b=b||[],f&&(f=f.substring(0,f.length-1),a('.ui-card[type="brand"]').html("<span>"+f+'</span><img src="image/down-red.png">'),a('.ui-card[type="brand"]').css({border:"1px solid red",background:"rgb(255,255,255)",color:"rgb(252,82,71)"})),i?(i=i.substring(0,i.length-1),a('.ui-card[type="expand"]').html("<span>"+i+'</span><img src="image/down-red.png">'),a('.ui-card[type="expand"]').css({border:"1px solid red",background:"rgb(255,255,255)",color:"rgb(252,82,71)"})):b.length>3&&(a('.ui-card[type="expand"]').html('<span>成色</span><img src="image/down.png">'),a('.ui-card[type="expand"]').css({border:"none",background:"#efefef",color:"#8c8c8c"}))},renderSearchBrandlist:function(b){b=b||[],a(".ui-area-class .ui-class").html(c.template(a(".renderSearchBrandlist").text())(b))},renderSearchextAttrList:function(b){b=b||[],a(".ui-area-class-color .ui-class").html(c.template(a(".renderSearchextAttrList").text())(b))},renderSearchextServiceList:function(b){b=b||[],b.length>0?(a(".top-content ul").html(c.template(a(".renderSearchextServiceList").text())(b)),a(".topView").show()):a(".topView").hide()},renderSearchextPriceList:function(b){b=b||[],a(".priceSection").html(c.template(a(".renderSearchextPriceList").text())(b))},renderSearchextSeleatBrandList:function(b){b=b||[],b&&b.length>0&&a(".item-brand").html(c.template(a(".renderSearchextSeleatBrandList").text())(b)),a(".item-content-brand").unbind("click").bind("click",function(){1==a(this).attr("state")?(a(this).find("img").removeClass("hide"),a(this).attr("state","0").css({border:"1px solid red",background:"rgb(255,255,255)",color:"rgb(252,82,71)"}),e.tempQuery.brandList[a(this).index()].isSelect=!0):0==a(this).attr("state")&&(a(this).find("img").addClass("hide"),a(this).attr("state","1").css({border:"none",background:"rgb(239,239,239)",color:"rgb(23,23,23)"}),e.tempQuery.brandList[a(this).index()].isSelect=!1)})},renderSearchextSeleatBrandSpellList:function(b){b=b||[];var d=e.query.brandList;d&&d.length>0&&(a(".index-list").html(c.template(a(".renderSearchextSeleatBrandSpellList").text())(b)),a(".index-list .index-sign").delegate("a","click",function(){e.animateScroll(a(".index-list ul"),a("li#"+a(this).attr("data-key")).offset().top+a(".index-list ul").scrollTop()-35,1e3)}))},renderSearchextSeleatColorList:function(b){b=b||[],b&&b.length>0?(a("#item-color").html(c.template(a(".renderSearchextSeleatColorList").text())(b)),a("#item-color").show()):a("#item-color").hide()},renderSearchextSeleatCatList:function(b){b=b||[],b&&b.length>0?(a(".panel-list ul").html(c.template(a(".renderSearchextSeleatCatList").text())(b)),a(".allClass").show()):a(".allClass").hide()},objKeySort:function(a){for(var b=Object.keys(a).sort(),c={},d=0;d<b.length;d++)c[b[d]]=a[b[d]];return c},animateScroll:function(a,b,c){a&&a.animate({scrollTop:b||0},c||100)}},e.init(),window.onpageshow=function(a){a.persisted&&e.init()}});