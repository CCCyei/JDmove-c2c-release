require(["jquery","utils","dot","downloadAppPlugIn_imk2"],function(a,b,c){"use strict";var d={downAppURl:"//paipai.m.jd.com/c2c/downLoadForPay.html",downAppIos:"",downWeixin:"",downIpad:"",inteneUrl:"openapp.paipai://marketHome/app",inteneUrlParams:{},sourceType:"JSHOP_SOURCE_TYPE",sourceValue:"JSHOP_SOURCE_VALUE",M_sourceFrom:"mxz",NoJumpDownLoadPage:!0,universalLinksUrl:"openapp.paipai://marketHome/app",noJdApp:!0},e=document.getElementById("downLoad"),f="//betadl.paipai.com/android/paipai_release.apk",g={dealId:b.getLoctionUrlParam(window.location.href,"dealId"),token:b.getLoctionUrlParam(window.location.href,"token"),init:function(){g.getAppDownUrl(function(){g.initAll()})},initAll:function(){window.screen.height>736?(a(".bg-downLoad").attr("src","image/bg-downLoad-long.jpg").removeClass("ui-hide"),a(".bt-downLoad").removeClass("ui-hide")):(a(".bg-downLoad").removeClass("ui-hide"),a(".bt-downLoad").removeClass("ui-hide")),g.addClick(),1==b.getDevicesType()?e.setAttribute("href",f):2==b.getDevicesType()&&e.setAttribute("href","//itunes.apple.com/cn/app/id1267714436"),g.openapp()},addClick:function(){a("#downLoad").unbind("click").bind("click",function(){if(3!=b.getDevicesType())try{var a="PaiPai_201712291|100",c=new MPing.inputs.Click(a);c.event_param=b.getLoginCodeType(),c.event_level="3",c.updateEventSeries();var d=new MPing;d.send(c),console.log(f)}catch(e){}})},getAppDownUrl:function(a){var c=b.getParameter("channel");if(b.isNotEmpty(c)){var d={url:b.getHost()+"/cms",data:{ids:"first_identifier"}};b.load(d).then(function(d){var e,g;"0"==d.code&&(b.isNotEmpty(d.data.first_identifier)&&d.data.first_identifier.length>0&&(console.log(JSON.stringify(d.data.first_identifier)),d.data.first_identifier.forEach(function(a){a.title==c&&(g=a.url),"defaulturl"==a.title&&(e=a.url)})),b.isNotEmpty(g)?f=g:b.isNotEmpty(e)&&(f=e),console.log(f)),a()},function(b){a()})}else a()},openapp:function(){"jd"==b.getAppType()?1==b.getDevicesType()?a.downloadAppPlugInOpenApp(d):2==b.getDevicesType():1==b.getDevicesType()?a.downloadAppPlugInOpenApp(d):2==b.getDevicesType()&&a.downloadAppPlugInOpenApp(d)},orderMeetConfirmReceived:function(){var a={url:b.getHost(1)+"/order/v1/deal/faceToFaceConfirmReceived",type:"POST",data:{dealId:g.dealId,machineKey:"test",token:g.token}};b.load(a).then(function(a){0==a.code?b.lightToast(a.tip||"已成功收款"):b.lightToast(a.tip||"网络异常"),g.openapp()})}};g.init()});