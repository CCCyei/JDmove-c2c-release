require(["jquery","utils","dot","ext","share"],function(a,b,c,d,e){var f="",g="",h={isLoading:!1,isLoading2:!1,isAllLoad:!1,isAllLoad2:!1,init:function(){h.getOtherUserByUin(),h.getSellList(),h.getPersonalOrderCommentList(),h.addClick(),d.init(h.defaultOpt)},para:{ouin:b.getParameter("ouin")||11041,page:1,page2:1,lastId:"0"},defaultOpt:{scheme_IOS:'openapp.paipai://pushToOthersHome/app?param={"key1":'+b.getUrlParam("ouin")+"}",scheme_Adr:'openapp.paipai://pushToOthersHome/app?param={"key1":'+b.getUrlParam("ouin")+"}"},addClick:function(){a(".ui-nav .ui-sell").click(function(){a(window).scrollTop(0),a(this).addClass("ui-select"),a(".ui-discuss").removeClass("ui-select"),a(".ui-sell-box").show(),a(".ui-discuss-box").hide(1),a(this).attr("deg","1"),a(".ui-nav .ui-discuss").attr("deg","0"),1==a(".ui-nav .ui-sell").attr("deg")?h.addScorll():1==a(".ui-nav.ui-discuss").attr("deg")&&h.addScorll2()}),a(".ui-nav .ui-discuss").click(function(){a(window).scrollTop(0),a(this).addClass("ui-select"),a(".ui-sell").removeClass("ui-select"),a(".ui-discuss-box").show(),a(".ui-sell-box").hide(1),a(this).attr("deg","1"),a(".ui-nav .ui-sell").attr("deg","0"),1==a(".ui-nav .ui-sell").attr("deg")?h.addScorll():1==a(".ui-nav .ui-discuss").attr("deg")&&h.addScorll2()}),a(".ui-sell-box .ui-header").click(function(){var b=a(this).attr("itemid");h.loadOrOpenApp(b)}),a(".ui-sell-box .ui-sell-img").click(function(){var b=a(this).attr("itemid");h.loadOrOpenApp(b)}),a(".ui-person").click(function(){return!1}),a(".ui-nav").click(function(){return!1})},loadOrOpenApp:function(a){function b(){var a=Date.now(),b=document.createElement("iframe");b.src=c.indexOf("os")>0?d.state().scheme_IOS:d.state().scheme_Adr,b.style.display="none",document.body.appendChild(b);var e=setTimeout(function(){var b=Date.now();(!a||b-a<d.timeout+200)&&(window.location=(c.indexOf("os")>0,"appDown.html"))},d.timeout);window.onblur=function(){clearTimeout(e)},document.addEventListener("visibilitychange",function(){clearTimeout(e)})}var c=navigator.userAgent.toLowerCase(),d={state:function(){var b={key1:a};return{scheme_IOS:"openapp.paipai://pushToC2CDetail/app?param="+encodeURIComponent(JSON.stringify(b)),scheme_Adr:"openapp.paipai://pushToC2CDetail/app?param="+encodeURIComponent(JSON.stringify(b))}},timeout:1e3};b()},addScorll:function(){a(window).on("scroll",function(){var b=a(window).scrollTop(),c=a(window).height(),d=document.body.scrollHeight;!h.isLoading&&!h.isAllLoad&&b+c+300>d&&(h.para.page+=1,h.isLoading=!0,h.getSellList())})},addScorll2:function(){a(window).on("scroll",function(){var b=a(window).scrollTop(),c=a(window).height(),d=document.body.scrollHeight;!h.isLoading2&&!h.isAllLoad2&&b+c+300>d&&(h.para.page2+=1,h.isLoading2=!0,h.getPersonalOrderCommentList())})},getOtherUserByUin:function(){var c={url:b.getHost()+"/user/getUserDetailByUin",data:{uin:h.para.ouin}};b.load(c).then(function(c){if(console.log("获取他人的用户信息"+c),console.log(c),"0"==c.code){f=c.data.nickname,g=c.data.icon;var d,h={url:"https://paipai.m.jd.com/c2c/personalSet.html?ouin="+b.getParameter("ouin")+"&_t="+(new Date).getTime()||"",title:"快来看Ta的拍拍二手主页",qzone_title:"快来看Ta的拍拍二手主页",wechat_title:"快来看Ta的拍拍二手主页",wechat_time_title:"快来看Ta的拍拍二手主页",wechat_desc:f+"的拍拍二手主页",qq_desc:f+"的拍拍二手主页",qzone_desc:f+"的拍拍二手主页",img:getImageIcon("/paipai/s120x120_",g,"!cc_1x1")||"https://paipai.m.jd.com/c2c/image/pai-2x.png",isCallBack:"Y"};d="h5"==b.getLoginType()?"":"jd",setTimeout(e.init(h,d),300),a(".ui-person-name").html(c.data.nickname),a(".ui-person-num").html("累计售出"+c.data.soldDealCnt+"个宝贝"),a(".ui-person-head img").attr("src",getImageIcon("/paipai/s120x120_",c.data.icon,"!cc_1x1")),1==c.data.isRealName&&(a(".ui-person-left img").attr("src","image/real-name1.png"),a(".ui-person-left p").html("已实名认证")),1==c.data.isRealPerson&&(a(".ui-person-center img").attr("src","image/real-persen1.png"),a(".ui-person-center p").html("已实人认证")),1==c.data.isWhiteCredit?1==c.data.isSwitchOn?(a(".ui-person-right img").attr("src","image/real-cd1.png"),a(".ui-person-right p").html("已开通小白信用")):a(".ui-person-right p").html("未授权小白信用"):a(".ui-person-right p").html("未开通小白信用")}},function(a){b.lightToast("网络异常，稍后重试")})},getSellList:function(){var c={url:b.getHost()+"/commodity/v1/getInStockItemList",data:{uin:h.para.ouin,pageIndex:h.para.page,pageSize:20,orderField:"2_2"}};b.load(c).then(function(c){console.log("获取在售商品"+c),console.log(c);var d=c.data.commodityList;(d||[]).forEach(function(a){var b=2.9*a.pics.length+"rem";a["with"]=b}),"0"==c.code&&(c.data.commodityList&&c.data.commodityList.length>0?(h.renderOnSellListInfo(c.data.commodityList),a(".bgview").hide(),h.isLoading=!1,(!c.data.commodityList||c.data.commodityList.length<20)&&(h.isAllLoad=!0)):1==h.para.page?(a(".bgview").addClass("bgSell").removeClass("hide"),a(".bgview p").text("暂无在售商品")):b.lightToast("没有更多了"))},function(a){b.lightToast("网络异常，稍后重试")})},getPersonalOrderCommentList:function(){var c={url:b.getHost()+"/orderComment/personalOrderCommentList",data:{uin:h.para.ouin,currentPage:h.para.page2,pageSize:20,lastId:h.para.lastId}};b.load(c).then(function(c){if(console.log("获取個人主頁評價"+c),console.log(c),"0"==c.code){h.para.lastId=c.data.lastId,a(".ui-discuss-num").html("共"+c.data.totalCount+"条评价，好评数"+c.data.praiseCount+"条"),a(".ui-nav .ui-discuss").html("评价("+c.data.totalCount+")");var d=c.data.result;(d||[]).forEach(function(a){if(a.pics&&a.pics.length>0){var b=1.72*a.pics.length+"rem";a["with"]=b}}),c.data.result&&c.data.result.length>0?(h.renderSellListInfo(c.data.result),a(".bgview").hide(),h.isLoading2=!1,(!c.data.result||c.data.result.length<20)&&(h.isAllLoad2=!0)):1==h.para.page2?(a(".ui-nav .ui-discuss").html("评价"),a(".bgview2").addClass("bgSell"),a(".bgview2").removeClass("hide"),a(".bgview2 p").text("暂无评价"),a(".bgview2 img").attr("src","image/nomeage.png")):b.lightToast("没有更多了")}},function(a){b.lightToast("网络异常，稍后重试")})},renderSellListInfo:function(b){b=b||[],a(".ui-discuss-box").append(c.template(a(".renderSellListInfo").text())(b))},renderOnSellListInfo:function(b){b=b||[],a(".ui-sell-box").append(c.template(a(".renderOnSellListInfo").text())(b)),h.addClick()}};h.init()});