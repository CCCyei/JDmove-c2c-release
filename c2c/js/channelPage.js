function showDate(a){var b=!1;return 36e3>nowDate-a/1e3&&(b=!0),b}var nowDate=0;window.devicePixelRatio&&window.devicePixelRatio>=2&&$(".cpf-kinds-content").addClass("hairlines"),require(["jquery","utils","dot","ext","upreport","share","fastclick"],function(a,b,c,d,e,f,g){"use strict";g.attach(document.body);var h,i={init:function(){e.init(),a(".cpf-tip").removeClass("hide"),i.goScroll(),i.req.getAds("channel_ad,pool_index,paipai_tips"),i.addClick(),3==b.getType()?(d.init(),a(".btn-public").addClass("ui-hide")):a(".btn-public").removeClass("ui-hide"),i.initShareInfo(),window.devicePixelRatio&&window.devicePixelRatio>=2&&a(".cpf-kinds-content").addClass("hairlines"),i.initScroll(),i.setShare()},isFirst:!0,isLoading:!1,count:"",para:{kindsWidth:2e3,item:[],num:1,top:"",firstTime:0,isTop:!1,isScroll:!1,isLast:!1},addClick:function(){a(".cpt-img ul").undelegate("li","click").delegate("li","click",function(){var c=a(this).data("ids"),d=a(this).data("title");b.goUrl("/channelPageExt.html?pool_1="+c+"&title="+encodeURIComponent(d))}),a("#kindsShow").undelegate("li","click").delegate("li","click",function(){a(this).addClass("curr").siblings().removeClass("curr"),a("#kindsShow b").addClass("ui-hide"),a(this).find("b").removeClass("ui-hide"),i.req.getPoolItem()}),a(".cpf-list").undelegate(".item-heart","click").delegate(".item-heart","click",function(){var b=a(this),c=b.data("tag"),d=b.data("commentid"),e=parseInt(b.data("num")),f="";0==c?(c=1,f="image/icon_heart.png",e-=1):(c=0,f="image/icon_heart_se.png",e+=1),i.req.savaInterest(d,c,function(){b.html('<img src="'+f+'"><div class="ui-zan">'+e+"</div>"),b.data("tag",c),b.data("num",e)})}),a(".item-img-list").undelegate("ul","click").delegate("ul","click",function(){var b=a(this).children("li").data("commentid");console.log(b),location.href='openapp.paipai://pushToC2CDetail/app?param={"key1":'+b+"}"}),a(".cp-floor").undelegate(".item-comment","click").delegate(".item-comment","click",function(){var b=a(this).data("commentid");location.href='openapp.paipai://pushToC2CDetail/app?param={"key1":'+b+"}"}),a(".cp-floor").undelegate(".item-title","click").delegate(".item-title","click",function(){var b=a(this).data("commentid");location.href='openapp.paipai://pushToC2CDetail/app?param={"key1":'+b+"}"}),a(".btn-tap").unbind("click").bind("click",function(){b.setDoubleClick(function(){location.href="openapp.paipai://publish/app"})}),a(".cpf-item").undelegate(".it-left img","click").delegate(".it-left img","click",function(){var b=a(this).data("uin");location.href='openapp.paipai://getUserInfo/app?param={"uin":"'+b+'"}'}),a("#scroll-banner").undelegate("a","click").delegate("a","click",function(){var b=a(this).data("href");location.href=b})},initShareInfo:function(){var a={method:"setAPPInfo",params:{type:1,title:"拍拍二手- 京东订单一键转卖",subTitle:"自主定价、信息真实、最大程度保障交易安全",shareUrl:window.location.href,imgUrl:"http://paipai.m.jd.com/c2c/image/pai-2x.png"}};b.setAppInfo(a);var c={method:"setAPPInfo",params:{type:2,title:"标题",searchType:1,key:"手机"}};b.setAppInfo(c)},setShare:function(){var a,c={url:window.location.href,title:"拍拍二手- 京东订单一键转卖",qzone_title:"拍拍二手- 京东订单一键转卖",wechat_title:"拍拍二手- 京东订单一键转卖",wechat_time_title:"自主定价、信息真实、最大程度保障交易安全",wechat_desc:"自主定价、信息真实、最大程度保障交易安全",qq_desc:"自主定价、信息真实、最大程度保障交易安全",qzone_desc:"自主定价、信息真实、最大程度保障交易安全",img:"https://paipai.m.jd.com/c2c/image/pai-2x.png",isCallBack:"Y"};a="h5"==b.getLoginType()?"":"jd",setTimeout(f.init(c,a),300)},initScroll:function(){window.addEventListener("scroll",function(){var c=document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop,d=b.setUrlParam(window.location.href,"translateY",c),e=(new Date).getTime(),f=i.para.firstTime;e-f>300&&(i.para.firstTime=e,history.replaceState("",document.title,d)),b.scrollLoad({loadData:function(){i.para.isLast||(i.para.num++,i.req.getPoolItem(!0))}}),i.para.isScroll?i.para.isScroll=!1:b.isNotEmpty(i.para.top)&&c>=i.para.top?(a(".cpf-kinds-list").css({position:"fixed",top:"0"}),i.para.isTop=!0,a(".cpf-list").addClass("addminheight")):i.para.top-c<40&&3!=b.getType()&&i.para.isLast?(a(".cpf-kinds-list").css({position:"fixed",top:"0"}),i.para.isTop=!0,a(".cpf-list").addClass("addminheight")):(a(".cpf-kinds-list").css({position:"relative",top:"0"}),i.para.isTop=!1,a(".cpf-list").removeClass("addminheight"))})},goScroll:function(){var a=b.getParameter("translateY");null!=a&&window.scrollTo(0,a)},req:{getAds:function(c){var d={url:b.getHost()+"/cms",data:{ids:c}};b.load(d).then(function(c){"0"==c.code?(b.isNotEmpty(c.data.channel_ad)&&i.render.channelAd(c.data.channel_ad),b.isNotEmpty(c.data.pool_index)&&(i.render.pool(c.data.pool_index),i.para.top=a(".cpf-kinds-list").offset().top),b.isNotEmpty(c.data.paipai_tips)&&i.render.scrollBanner(c.data.paipai_tips)):(i.para.top=a(".cpf-kinds-list").offset().top,b.isNotEmpty(c.tip)?b.lightToast(c.tip):console.log("广告信息获取异常"))},function(c){i.para.top=a(".cpf-kinds-list").offset().top,b.isNotEmpty(c)&&console.log(c),b.lightToast("网络有误 请再试一次")})},getPoolItem:function(c,d,e){b.isEmpty(c)&&(i.para.num=1),b.isEmpty(d)&&(d=a("#kindsShow  .curr").data("poolid"));var f={url:b.getHost()+"/item/v1/getPoolItem",data:{poolId:d,pageIndex:i.para.num,pageSize:10}};b.isNotEmpty(e)&&(f.data={poolId:d,pageSize:50,pageIndex:1,flag:1}),b.load(f).then(function(a){i.isLoading=!1,nowDate=a.currentTime,"0"==a.code?b.isNotEmpty(e)?e(a.data):(i.render.itemList(a.data),b.isEmpty(a.data)||b.isNotEmpty(a.data)&&0==a.data.length?i.para.isLast=!0:i.para.isLast=!1):b.isNotEmpty(a.tip)?b.lightToast(a.tip):console.log("获取商品池信息异常")},function(a){b.lightToast("网络有误 请再试一次"),b.para.last++})},savaInterest:function(a,c,d){var e={url:b.getHost()+"/interest/save",data:{commodityId:a,isInterest:c}};b.load(e).then(function(a){"0"==a.code?(0==c&&b.lightToast("收藏成功在我的收藏查看"),b.isNotEmpty(d)&&d()):b.isNotEmpty(a.tip)?b.lightToast(a.tip):console.log("获取商品池信息异常")},function(a){b.lightToast("网络有误 请再试一次")})}},render:{channelAd:function(d){d=d||[],d.length>0?a(".cpt-img ul").html(c.template(a(".channelAd").text())(d)):b.log("广告数据异常"),i.addClick()},pool:function(d){d=d||[],d.length>0?a("#kindsShow").html(c.template(a(".pool").text())(d)):b.log("广告数据异常"),i.setPoolSelect(),i.addClick(),a("#kindsShow").attr("clstag","pageclick|keycount|PaiPai_201712112|11")},scrollBanner:function(d){d=d||[];var e=[];if(d.length>0){var f=d[0];b.isNotEmpty(f.url)&&-1==f.url.indexOf("//")&&(f.url="//"+f.url),f.img="",e.push(f),a("#scroll-banner ul").html(c.template(a(".scrollBanner").text())(e)),i.req.getPoolItem(!1,f.poolId,function(d){if(d.forEach(function(a,c){var g={};g.title=b.isNotEmpty(a.nickname)?a.nickname:"匿名",g.desc=b.isNotEmpty(a.commodityTitle)?a.commodityTitle:a.charactersDesc,g.ids=a.commodityId,g.img=a.icon;var h={key1:a.commodityId},i=g.desc.split("\\n");i.length>0?g.desc=i[0]:g.desc=g.desc,g.url="openapp.paipai://pushToC2CDetail/app?param="+encodeURIComponent(JSON.stringify(h)),e.push(g),c!=d.length-1&&e.push(f)}),e.length>0?a("#scroll-banner ul").html(c.template(a(".scrollBanner").text())(e)):b.log("广告数据异常"),a("#scroll-banner ul").length>0){var g=a("#scroll-banner");b.isNotEmpty(h)&&clearInterval(h),h=setInterval(function(){b.scrollNews(g)},3e3)}i.addClick()})}},itemList:function(b){b&&b.length>0?(1!=i.para.num?a(".cpf-list").append(c.template(a(".itemList").text())(b)):(a(".cpf-list").html(c.template(a(".itemList").text())(b)),i.para.isTop?(a(".cpf-list").addClass("addminheight"),i.para.isScroll=!0,window.scrollTo(0,i.para.top)):a(".cpf-list").removeClass("addminheight")),a(".cpf-list").removeClass("hide"),a(".bgview").addClass("hide")):(1==i.para.num&&(a(".bgview").removeClass("hide").addClass("bgview2"),a(".cpf-list").addClass("hide"),a(".bgview p").text("你查看的商品不见了~")),console.log("这里没有数据")),i.addClick(),a(".item-heart").attr("clstag","pageclick|keycount|PaiPai_201712112|12"),a(".item-comment").attr("clstag","pageclick|keycount|PaiPai_201712112|13")}},setPoolSelect:function(){var c=b.getParameter("poolId");b.isNotEmpty(c)?a("#kindsShow li").each(function(){a(this).data("poolid")==c&&a(this).click()}):a("#kindsShow li").first().click()}};i.init(),window.onpageshow=function(a){a.persisted&&i.initShareInfo()}});