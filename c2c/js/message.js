require(["jquery","utils","dot"],function(a,b,c){var d={page:1,isLoading:!1,isAllLoad:!1,init:function(){d.getDealDetail()},addClick:function(){a(".ui-box").unbind("click").bind("click",function(){var b=a(this).attr("venderId");location.href="//chat.jd.com/chat/index.action?venderId="+b+"&customerAppId=lease.customer&entry=jd_m_paipai_app_item&refresh=no&pid="})},addScorll:function(){a(window).on("scroll",function(){var b=a(window).scrollTop(),c=a(window).height(),e=document.body.scrollHeight;!d.isLoading&&!d.isAllLoad&&b+c+300>e&&(d.page+=1,d.isLoading=!0,d.getDealDetail())})},getDealDetail:function(){var c={url:b.getHost()+"/ddChat/sessionList",data:{}};b.load(c).then(function(c){console.log(c),c&&0==c.code?c.data&&c.data.length>0?(d.renderProductInfo(c.data),d.addClick(),d.isLoading=!1,(!c.data.result||c.data.result.length<50)&&(d.isAllLoad=!0)):(a(".bgview").removeClass("hide"),a(".bgview p").text("暂时没有消息~"),a(".bgview img").attr("src","image/nomeage.png")):b.isNotEmpty(c.tip)?b.lightToast(c.tip):b.lightToast("消息列表数据异常")},function(a){b.lightToast("网络异常，稍后重试")})},renderProductInfo:function(b){a("body").html(c.template(a(".product-info").text())(b))}};d.init(),window.addEventListener("pageshow",function(a){location.reload(!0)})});