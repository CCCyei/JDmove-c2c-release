require(["jquery","utils","dot"],function(a,b,c){var d={init:function(){d.getDefaultPara(),d.addClick(),d.listenInputChange()},para:{type:"new",nickName:"",editAbleNickName:"",lastNickNameTime:""},addClick:function(){a(".clear").unbind("click").bind("click",function(){d.clearInput()}),a(".confirmBar-updata").unbind("click").bind("click",function(){var c=/[\u4E00-\u9FA5A-Za-z0-9_-]$/;d.checkNickLength()&&(c.test(a("#userNickInput").val())&&0!==a("#userNickInput").val().indexOf("@")&&0!==a("#userNickInput").val().indexOf("!")&&0!==a("#userNickInput").val().indexOf("#")&&0!==a("#userNickInput").val().indexOf("$")&&0!==a("#userNickInput").val().indexOf("%")&&0!==a("#userNickInput").val().indexOf("^")&&0!==a("#userNickInput").val().indexOf("&")&&0!==a("#userNickInput").val().indexOf("*")&&0!==a("#userNickInput").val().indexOf("(")&&0!==a("#userNickInput").val().indexOf(")")&&0!==a("#userNickInput").val().indexOf("=")&&0!==a("#userNickInput").val().indexOf("+")&&0!==a("#userNickInput").val().indexOf("~")&&0!==a("#userNickInput").val().indexOf("?")&&0!==a("#userNickInput").val().indexOf(">")&&0!==a("#userNickInput").val().indexOf("<")&&0!==a("#userNickInput").val().indexOf(":")&&0!==a("#userNickInput").val().indexOf('"')&&0!==a("#userNickInput").val().indexOf("|")&&0!==a("#userNickInput").val().indexOf("{")&&0!==a("#userNickInput").val().indexOf("}")&&0!==a("#userNickInput").val().indexOf("[")&&0!==a("#userNickInput").val().indexOf("]")&&0!==a("#userNickInput").val().indexOf("/")&&0!==a("#userNickInput").val().indexOf("@")&&0!==a("#userNickInput").val().indexOf("——")&&0!==a("#userNickInput").val().indexOf("！")&&0!==a("#userNickInput").val().indexOf("#")&&0!==a("#userNickInput").val().indexOf("￥")&&0!==a("#userNickInput").val().indexOf("%")&&0!==a("#userNickInput").val().indexOf("……")&&0!==a("#userNickInput").val().indexOf("&")&&0!==a("#userNickInput").val().indexOf("*")&&0!==a("#userNickInput").val().indexOf("（")&&0!==a("#userNickInput").val().indexOf("）")&&0!==a("#userNickInput").val().indexOf("=")&&0!==a("#userNickInput").val().indexOf("+")&&0!==a("#userNickInput").val().indexOf("~")&&0!==a("#userNickInput").val().indexOf("？")&&0!==a("#userNickInput").val().indexOf("》")&&0!==a("#userNickInput").val().indexOf("《")&&0!==a("#userNickInput").val().indexOf("：")&&0!==a("#userNickInput").val().indexOf("“")&&0!==a("#userNickInput").val().indexOf("|")&&0!==a("#userNickInput").val().indexOf("{")&&0!==a("#userNickInput").val().indexOf("}")&&0!==a("#userNickInput").val().indexOf("【")&&0!==a("#userNickInput").val().indexOf("】")&&0!==a("#userNickInput").val().indexOf("、")?d.setCompareTime(d.para.lastNickNameTime)?d.updataNickInfo(a("#userNickInput").val()):b.lightToast("未到可修改时间~"):1==a("#userNickInput").val().indexOf("-")||2==a("#userNickInput").val().indexOf("-")||3==a("#userNickInput").val().indexOf("-")||4==a("#userNickInput").val().indexOf("-")||5==a("#userNickInput").val().indexOf("-")||6==a("#userNickInput").val().indexOf("-")||7==a("#userNickInput").val().indexOf("-")||8==a("#userNickInput").val().indexOf("-")||9==a("#userNickInput").val().indexOf("-")||10==a("#userNickInput").val().indexOf("-")?d.setCompareTime(d.para.lastNickNameTime)||b.isEmpty(d.para.type)?d.updataNickInfo(a("#userNickInput").val()):b.lightToast("未到可修改时间~"):b.lightToast("昵称不能包含除-和_以外的特殊字符"))}),a(".confirmBar-new").unbind("click").bind("click",function(){var c=/[\u4E00-\u9FA5A-Za-z0-9_-]+$/;d.checkNickLength()&&(c.test(a("#userNickInput").val())&&0!==a("#userNickInput").val().indexOf("@")&&0!==a("#userNickInput").val().indexOf("!")&&0!==a("#userNickInput").val().indexOf("#")&&0!==a("#userNickInput").val().indexOf("$")&&0!==a("#userNickInput").val().indexOf("%")&&0!==a("#userNickInput").val().indexOf("^")&&0!==a("#userNickInput").val().indexOf("&")&&0!==a("#userNickInput").val().indexOf("*")&&0!==a("#userNickInput").val().indexOf("(")&&0!==a("#userNickInput").val().indexOf(")")&&0!==a("#userNickInput").val().indexOf("=")&&0!==a("#userNickInput").val().indexOf("+")&&0!==a("#userNickInput").val().indexOf("~")&&0!==a("#userNickInput").val().indexOf("?")&&0!==a("#userNickInput").val().indexOf(">")&&0!==a("#userNickInput").val().indexOf("<")&&0!==a("#userNickInput").val().indexOf(":")&&0!==a("#userNickInput").val().indexOf('"')&&0!==a("#userNickInput").val().indexOf("|")&&0!==a("#userNickInput").val().indexOf("{")&&0!==a("#userNickInput").val().indexOf("}")&&0!==a("#userNickInput").val().indexOf("[")&&0!==a("#userNickInput").val().indexOf("]")&&0!==a("#userNickInput").val().indexOf("/")&&0!==a("#userNickInput").val().indexOf("@")&&0!==a("#userNickInput").val().indexOf("——")&&0!==a("#userNickInput").val().indexOf("！")&&0!==a("#userNickInput").val().indexOf("#")&&0!==a("#userNickInput").val().indexOf("￥")&&0!==a("#userNickInput").val().indexOf("%")&&0!==a("#userNickInput").val().indexOf("……")&&0!==a("#userNickInput").val().indexOf("&")&&0!==a("#userNickInput").val().indexOf("*")&&0!==a("#userNickInput").val().indexOf("（")&&0!==a("#userNickInput").val().indexOf("）")&&0!==a("#userNickInput").val().indexOf("=")&&0!==a("#userNickInput").val().indexOf("+")&&0!==a("#userNickInput").val().indexOf("~")&&0!==a("#userNickInput").val().indexOf("？")&&0!==a("#userNickInput").val().indexOf("》")&&0!==a("#userNickInput").val().indexOf("《")&&0!==a("#userNickInput").val().indexOf("：")&&0!==a("#userNickInput").val().indexOf("“")&&0!==a("#userNickInput").val().indexOf("|")&&0!==a("#userNickInput").val().indexOf("{")&&0!==a("#userNickInput").val().indexOf("}")&&0!==a("#userNickInput").val().indexOf("【")&&0!==a("#userNickInput").val().indexOf("】")&&0!==a("#userNickInput").val().indexOf("、")?d.setCompareTime(d.para.lastNickNameTime)||b.isEmpty(d.para.type)?d.updataNickInfo(a("#userNickInput").val()):b.lightToast("未到可修改时间~"):1==a("#userNickInput").val().indexOf("-")||2==a("#userNickInput").val().indexOf("-")||3==a("#userNickInput").val().indexOf("-")||4==a("#userNickInput").val().indexOf("-")||5==a("#userNickInput").val().indexOf("-")||6==a("#userNickInput").val().indexOf("-")||7==a("#userNickInput").val().indexOf("-")||8==a("#userNickInput").val().indexOf("-")||9==a("#userNickInput").val().indexOf("-")||10==a("#userNickInput").val().indexOf("-")?d.setCompareTime(d.para.lastNickNameTime)||b.isEmpty(d.para.type)?d.updataNickInfo(a("#userNickInput").val()):b.lightToast("未到可修改时间~"):b.lightToast("昵称不能包含除-和_以外的特殊字符"))})},checkNickLength:function(){return a("#userNickInput").val().length<2?(b.lightToast("请输入2-10个字符作为昵称~"),!1):!0},listenInputChange:function(){a("#userNickInput").bind("input propertychange",function(){""==a(this).val()?a(".clear").addClass("hide"):a(".clear").removeClass("hide")})},getDefaultPara:function(){d.para.type=b.getParameter("type"),d.para.nickName=b.getParameter("nickName"),d.para.editAbleNickName=b.getParameter("editAbleNickName"),d.para.lastNickNameTime=b.getParameter("lastNickNameTime"),a(".dateInfo").text(d.getformatDateTime(d.para.lastNickNameTime)),"updata"==d.para.type?(a("#userNickInput").val(d.para.nickName),a(".notice-updata").removeClass("hide"),a(".notice-new").addClass("hide"),a(".confirmBar-updata").removeClass("hide"),a(".confirmBar-new").addClass("hide")):(d.setNickInfo(),a(".notice-updata").addClass("hide"),a(".notice-new").removeClass("hide"),a(".confirmBar-updata").addClass("hide"),a(".confirmBar-new").removeClass("hide"))},getformatDateTime:function(a){var c,e;b.isNotEmpty(a)?(c=Number(a)+Number(d.getDayInfo(90)),e=new Date(c)):(c=new Date,e=new Date(c.getTime()+Number(d.getDayInfo(90))));var f=e.getFullYear(),g=e.getMonth()+1;g=10>g?"0"+g:g;var h=e.getDate();h=10>h?"0"+h:h;var i=(e.getHours(),e.getMinutes());return i=10>i?"0"+i:i,f+"-"+g+"-"+h},setCompareTime:function(a){var c,e;return b.isNotEmpty(a)?(c=new Date,e=Number(a)+Number(d.getDayInfo(90)),e>c?!1:!0):(c=new Date,e=new Date(c.getTime()+Number(d.getDayInfo(90))),e>c?!1:!0)},getDayInfo1:function(a){var b=60*a*1e3;return b},getDayInfo:function(a){var b=24*a*60*60*1e3;return b},clearInput:function(){a("#userNickInput").val(""),a(".clear").addClass("hide")},updataNickInfo:function(c){var e={url:b.getHost()+"/user/updateNickname",data:{nickName:c}};b.load(e).then(function(c){b.isNotEmpty(c)&&"0"==c.code?(d.para.type="updata",a(".confirmBar-new").hasClass("hide")?(b.lightToast("昵称修改成功~"),location.href="openapp.paipai://changeNickname/app",setTimeout(function(){b.goUrl("/userSetting.html")},1e3)):b.lightToast("设置成功，欢迎进入拍拍")):b.isNotEmpty(c.tip)?b.lightToast(c.tip):b.lightToast("昵称修改失败~")},function(a){b.lightToast(a)})},setNickInfo:function(){var c={url:b.getHost()+"/user/initialNickname",data:{}};b.load(c).then(function(c){b.isNotEmpty(c)&&"0"==c.code&&b.isNotEmpty(c.data)?a("#userNickInput").val(c.data):b.lightToast(c.tip)},function(a){b.lightToast(a)})}};d.init()});