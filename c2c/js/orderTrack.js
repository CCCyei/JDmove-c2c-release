require(["jquery","utils","dot"],function(a,b,c){var d={init:function(){d.addClick(),d.getDefaultPara(),d.getDeliveryInfo(),b.isNotEmpty(d.para.dealId)&&d.getDealDetail()},para:{wayBillCode:"",logisticsCode:"",mainImgUrl:"",dealId:""},addClick:function(){},getDefaultPara:function(){d.para.wayBillCode=b.getParameter("wayBillCode"),d.para.logisticsCode=b.getParameter("logisticsCode"),d.para.mainImgUrl=b.getParameter("mainImgUrl"),d.para.dealId=b.getParameter("dealId")},renderDeliveryInfo:function(b){b=b||{},b.listTrace&&b.listTrace.length&&(b.tel=b.listTrace[b.listTrace.length-1].courierTel),a(".ui-deliveryInfo").html(c.template(a(".deliveryInfo").text())(b)),d.addClick()},getDeliveryInfo:function(){var c={url:b.getHost(1)+"/logistics/queryLogisticsDetail",data:{wayBillCode:d.para.wayBillCode,logisticsCode:d.para.logisticsCode}};b.load(c).then(function(c){b.isNotEmpty(c)&&"0"==c.code&&b.isNotEmpty(c.data)?(a(".bgview").addClass("hide"),d.renderDeliveryInfo(c.data),a(".mainImgUrl").attr("src",getImageHost()+"/paipai/s180x180_"+d.para.mainImgUrl)):(a(".bgview").removeClass("hide"),a(".bgview p").text("暂时还没有物流信息哦~"),a(".bgview img").attr("src","image/notrack.png"))},function(b){a(".bgview").removeClass("hide"),a(".bgview p").text("数据加载失败，请点击刷新~"),a(".bgview").unbind("click").bind("click",function(){d.getDefaultPara(),d.getDeliveryInfo()})})},getDealDetail:function(){var c={url:b.getHost(4)+"/order/v1/deal/secGetDealDetail",data:{dealId:d.para.dealId}};b.load(c).then(function(b){b&&0==b.code&&(console.log(JSON.stringify(b)),0==b.code&&b.data.pic&&b.data.pic.length>0&&a(".mainImgUrl").attr("src",getImageHost()+"/paipai/s180x180_"+b.data.pic[0]))},function(a){b.lightToast("网络异常，稍后重试")})}};d.init()});