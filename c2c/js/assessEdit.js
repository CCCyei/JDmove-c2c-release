require(["jquery","utils","dot","uploadShowLocalPic"],function(a,b,c){"use strict";var d={obj:{pic:[],orderId:"",context:"",commentMark:"",isMasterComment:1},init:function(){var a=b.getUrlParam("orderId");return a?(d.obj.orderId=a,void d.bindEvents()):void b.lightToast("缺少参数")},bindEvents:function(){b.changeLength(".reverse-remark-textarea",300,function(a){d.obj.context=a}),a(".assess-btns").delegate("span","click",function(){var b=a(this).attr("data-commentMark");b!=d.obj.commentMark&&(d.obj.commentMark=b,a(".assess-btns span").removeClass("active"),1==b?a('.assess-btns span[data-commentMark="1"]').addClass("active"):a('.assess-btns span[data-commentMark="2"]').addClass("active"))}),a(".reverse-footer").delegate("span","click",function(){var a=d.obj;if(a.context)if(a.commentMark){var c=[];for(var e in imgObj){if(imgObj[e].length>0&&b.checkBase64(imgObj[e]))return void b.lightToast("存在未上传完的图片");c.push(imgObj[e])}d.obj.pic=c.toString();var f={url:b.getHost()+"/orderComment/add",data:d.obj};b.load(f).then(function(a){if(0==a.code){var c="?commentId="+a.data+"&orderId="+d.obj.orderId;b.goUrl("/evaDetail.html"+c)}else b.isNotEmpty(a.tip)?b.lightToast(a.tip):b.lightToast(a.tip)},function(a){})}else b.lightToast("请选择是否给个好评");else b.lightToast("请填写评价说明")})}};d.init()});